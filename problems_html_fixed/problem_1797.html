<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Problem 1797</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="MathJax-4.0.0/tex-svg.js"></script>
<style>
body { font-family: Arial, sans-serif; margin: 40px; }
h1 { font-size: 1.6em; }
.difficulty { color: gray; font-size: 0.95em; margin-top: 6px; } .skib {  border-left: 4px solid #000; /* Bold left accent */   background-color: lavender; /* Very light gray */   padding: 1px 20px; /* less top/bottom padding, same left/right */   box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* Soft depth */}
p { line-height: 1.45; }
ol, ul { margin-left: 1.2em; }
li { margin-bottom: 0.4em; }
</style>
</head>
<body>
<h1>Problem 1797 - 2023 IMC, P4 of 10 (adapted), N</h1>
<h2 class='difficulty'>Difficulty: 7</h2>
<p>Let \(p>2\) be a prime number and let \(k\) be a positive integer. Suppose that the numbers \(a_i=i^k+i\) for \(i=0,1, \ldots,p-1\) leave pairwise distinct remainders upon division by \(p\). What is the set of possible remainders of \(a_2\) upon division by \(p\)?</p>
<h2>Thinking</h2>
<div class=skib>
<p>The distint remainders condition means that for any \(i\), \(j\),
\[i^k + i \not \equiv j^k + j \pmod{p}\]
Of course, taking \(i = 0\) and \(1\), we observe that \(0\) and \(2\) are off limits:
\[i^k \not \equiv -i \pmod{p}\]
\[i^k \not \equiv 2 - i \pmod{p}\]
Note that \(k\) is odd, if otherwise then \((p - 1)^k + (p - 1) \equiv 0 \pmod{p}\). Thus the value for \(p - 1\) is \(-2\), and all the values from \((p + 1)/2\) to \(p - 1\) are just negations of the values from \(1\) to \((p - 1)/2\).
\[i^k - j^k \not \equiv j - i \implies i^{k-1} + i^{k-2}j + \dots + ij^{k-2} + j^{k-1} \not \equiv -1 \pmod{p}\]
Suppose \(j = ir\). Then
\[i^{k-1}(1 + r + r^2 + \dots + r^{k-1}) \not \equiv -1 \pmod{p}\]
Suppose \(i \neq 0\), since \(r\) takes on every value and \(1/i^k\) is constant, we want to have
\[1 + r + r^2 + \dots + r^{k-1} \not \equiv \frac{-1}{i^{k-1}} \pmod{p}\]
for any value of \(r \neq 1\). In fact, since \(i\) can vary, we want to show that for any \(i \neq 0\), we don't have 
\[1 + r + r^2 + \dots + r^{k-1} \equiv \frac{-1}{i^{k-1}} \pmod{p}\]
for any value of \(r \neq 1\). Let \(s = i^{-1}\), to reframe as no \(r \neq 1\) and no \(s \neq 0\) such that
\[1 + r + r^2 + \dots + r^{k-1} \equiv -s^{k-1} \pmod{p}\]
So the polynomial \(-(1 + x + \dots + x^{k-1})\) does not take nonzero \((k-1)\)th power values apart from at \(x = 1\). </p>
<p>Let me end that long paragraph of fruitless pointwise injectivity and now turn to look at surjectivity which is basically global injectivity, or maybe just random global nonsense, though I can only cry for the information lost. 
\[1^k + 2^k + \dots + (p - 1)^k \equiv 0 \pmod{p} \implies p -1 \nmid k \] 
\[1^{k - 1} + 2^{k - 1} + \dots + (p - 1)^{k-1} \equiv \text{?} \pmod{p}\]
\[(1^{k-1} + 1)(2^{k-1} + 1)\dots ((p-1)^{k-1} + 1) \equiv 1 \pmod{p}\]
We know there are \(g = \gcd(p - 1, k - 1)\) numbers \(i\) such that \(i^{k-1} \equiv 1\). Thus there are \(g\) elements in each class with equal \(i^{k-1}\), and \((p - 1) / g\) classes are formed.
\[((i_1^{k-1} + 1) (i_2^{k-1} + 1) \dots (i_{(p-1)/g}^{k-1} + 1))^g \equiv 1 \pmod{p}\] 
For some reason, this reminds me of something... cyclotomic? If \(k = 2\), then this would be equal to 
\[(1 + 1)(1 + 2)\dots(1 + (p -1)) \equiv 0 \pmod{p}\]
But also
\[(x - 1)(x - 2) \dots (x - (p - 1)) \equiv x^{p - 1} - 1 \pmod{p}\]
If \(k = 3\), then it would be equal to
\[((1 + q_1) (1 + q_2) \dots (1 + q_{(p-1)/2}))^2\]
where the \(q_i\) are the nonzero quadratic residues mod \(p\). But
\[(x - q_1)(x - q_2)\dots (x - q_{(p-1)/2}) = x^{(p-1)/2} - 1 \implies ((1 + q_1) (1 + q_2) \dots (1 + q_{(p-1)/2}))^2 = ((-1)^{(p-1)/2} - 1)^2\]
Oh, I understand it now! 
\[1 \equiv ((i_1^{k-1} + 1) (i_2^{k-1} + 1) \dots (i_{(p-1)/g}^{k-1} + 1))^g \equiv ( (-1)^{(p-1)/g} - 1)^g \pmod{p}\] 
Since the RHS cannot be \(0\), we must have \(1 \equiv (-2)^g \equiv 2^g\), which finishes, since now \(2^{k-1} \equiv 1\), and \(\boxed{a_2 = 4}\) must hold.
</p>
</div>
<h2>Idea</h2>
<p>The first thing to realise is that it is fine to leave pointwise injectivity and look instead globally - what is asked is weird and it might just spawn globally, even with the loss of information (before finding the solution, I thought it might have to do with \((1 + 1)^n\) or something). And of course, look at small cases.</p>
<p><a href="../problem_tracker.html">Back to Problem List</a></p>
</body>
</html>
